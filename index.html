<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Combust&iacute;vel para Manuten&ccedil;&atilde;o | Avia&ccedil;&atilde;o</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
        }
        .calculator-card {
            background-color: #2d3748;
            border: 1px solid #4a5568;
        }
        .btn-primary {
            background-color: #3b82f6;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #2563eb;
        }
        .input-field {
            background-color: #4a5568;
            border: 1px solid #718096;
            color: #e2e8f0;
        }
        .input-field::placeholder {
            color: #a0aec0;
        }
        .result-box {
            background-color: #1a202c;
            border: 1px dashed #4a5568;
        }
        .fuel-tank-visualization {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 5px;
            height: 100px;
            padding: 10px;
            border-radius: 8px;
            background-color: #4a5568;
            margin-top: 1rem;
        }
        .tank {
            background-color: #3b82f6;
            width: 30%;
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: height 0.5s ease-in-out;
            cursor: pointer;
        }
        .tank-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: #a0aec0;
        }
        .tank.center {
            width: 35%;
            background-color: #6366f1;
        }
        #modal {
            transition: opacity 0.3s ease;
        }
        .click-tooltip {
            position: absolute;
            background-color: #111827;
            color: #e5e7eb;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            z-index: 50;
            pointer-events: none;
            border: 1px solid #374151;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transform: translateX(-50%);
            white-space: nowrap;
            opacity: 1;
            transition: opacity 0.3s ease-out;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md mx-auto">
        <header class="text-center mb-6">
            <img src="https://i.imgur.com/9z3OZep.png" alt="J Logo" class="mx-auto h-20 w-auto mb-4">
            <h1 class="text-2xl font-bold text-white">Calculadora de Combust&iacute;vel</h1>
            <p class="text-sm text-gray-400">Para Boeing 737 NG & MAX</p>
        </header>

        <main id="calculator" class="calculator-card p-6 rounded-lg shadow-2xl">
            
            <div class="mb-4">
                <label for="aircraftType" class="block text-sm font-medium text-gray-300 mb-2">Aeronave:</label>
                <select id="aircraftType" class="w-full p-2 rounded-md input-field">
                    <option value="NG">737-700/800 (NG)</option>
                    <option value="MAX">737-8 MAX</option>
                </select>
            </div>

            <div class="mb-4">
                <label for="fuelInput" class="block text-sm font-medium text-gray-300 mb-2">Combust&iacute;vel Total (KG):</label>
                <input type="number" id="fuelInput" placeholder="Ex: 12500" class="w-full p-3 text-lg text-center rounded-md input-field">
            </div>

            <button onclick="calculateFuel()" class="w-full mt-4 p-3 rounded-md font-semibold text-white btn-primary">
                Calcular Distribui&ccedil;&atilde;o
            </button>

            <div id="results" class="mt-6 hidden">
                <h3 class="text-lg font-semibold text-center mb-2">Distribui&ccedil;&atilde;o nos Tanques</h3>
                <div class="grid grid-cols-3 gap-2 text-center">
                    <div class="result-box p-3 rounded-md">
                        <p class="text-sm text-gray-400">Tanque 1 (Asa)</p>
                        <p id="resultTank1" class="text-xl font-bold"></p>
                        <p id="resultTank1Percent" class="text-xs text-gray-300"></p>
                    </div>
                    <div class="result-box p-3 rounded-md">
                        <p class="text-sm text-gray-400">Central</p>
                        <p id="resultCentral" class="text-xl font-bold"></p>
                        <p id="resultCentralPercent" class="text-xs text-gray-300"></p>
                    </div>
                    <div class="result-box p-3 rounded-md">
                        <p class="text-sm text-gray-400">Tanque 2 (Asa)</p>
                        <p id="resultTank2" class="text-xl font-bold"></p>
                        <p id="resultTank2Percent" class="text-xs text-gray-300"></p>
                    </div>
                </div>

                <div class="fuel-tank-visualization">
                    <div id="visTank1" class="tank"><span class="tank-label">Asa 1</span></div>
                    <div id="visTankCenter" class="tank center"><span class="tank-label">Central</span></div>
                    <div id="visTank2" class="tank"><span class="tank-label">Asa 2</span></div>
                </div>

                <div class="mt-4 text-center result-box p-3 rounded-md">
                     <p class="text-sm text-gray-400">Total em Litros (densidade ~0.80 kg/L)</p>
                     <p id="totalLitros" class="text-xl font-bold"></p>
                </div>
            </div>
        </main>

        <footer class="text-center mt-6 space-y-4">
            <div class="bg-red-600 text-white p-3 rounded-lg flex items-center justify-center shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
                <span class="font-bold text-base">N&atilde;o opere o celular durante o abastecimento.</span>
            </div>

            <div class="bg-yellow-900/50 border border-yellow-700 text-yellow-300 px-4 py-2 rounded-lg text-sm">
                <p><strong>Aten&ccedil;&atilde;o:</strong> Ferramenta de aux&iacute;lio para casos de novos valores solicitados pelo comandante, altera&ccedil;&otilde;es ou aus&ecirc;ncia da fueling order.</p>
            </div>

            <div>
                <p class="text-xs text-gray-500 mt-4">Desenvolvido por AEROJ</p>
            </div>
        </footer>
    </div>

    <div id="modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden" onclick="closeModal()">
        <div class="bg-red-800 border border-red-600 rounded-lg p-6 max-w-sm mx-auto text-center" onclick="event.stopPropagation()">
            <h3 class="text-lg font-bold text-white mb-2">Erro no C&aacute;lculo</h3>
            <p id="modal-message" class="text-red-200 mb-4"></p>
            <button onclick="closeModal()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
                Entendido
            </button>
        </div>
    </div>

    <script>
        const AIRCRAFT_CONFIG = {
            "NG": {
                maxCapacity: 20896,
                wingTankCapacity: 3860,
            },
            "MAX": {
                maxCapacity: 20728,
                wingTankCapacity: 3814,
            }
        };
        const FUEL_DENSITY = 0.80;

        const aircraftTypeSelect = document.getElementById('aircraftType');
        const fuelInput = document.getElementById('fuelInput');
        const resultsDiv = document.getElementById('results');
        const modal = document.getElementById('modal');
        const modalMessage = document.getElementById('modal-message');

        function showModal(message) {
            modalMessage.innerHTML = message;
            modal.classList.remove('hidden');
            modal.classList.add('opacity-100');
        }

        function closeModal() {
            modal.classList.add('hidden');
            modal.classList.remove('opacity-100');
        }

        function calculateFuel() {
            const aircraft = aircraftTypeSelect.value;
            const config = AIRCRAFT_CONFIG[aircraft];
            
            let totalFuel = parseFloat(fuelInput.value);
            if (isNaN(totalFuel) || totalFuel <= 0) {
                showModal('Por favor, insira um valor de combust&iacute;vel total v&aacute;lido.');
                return;
            }
            
            if (totalFuel > config.maxCapacity) {
                showModal(`Erro: O combust&iacute;vel (${formatNumber(totalFuel)} KG) ultrapassa a capacidade m&aacute;xima da aeronave ${aircraft} de ${config.maxCapacity} KG.`);
                return;
            }

            distributeFuel(totalFuel, config);
        }

        function distributeFuel(totalFuel, config) {
            let centralFuel = 0;
            let tank1Fuel = 0;
            let tank2Fuel = 0;
            const wingTanksTotalCapacity = config.wingTankCapacity * 2;

            if (totalFuel <= wingTanksTotalCapacity) {
                tank1Fuel = totalFuel / 2;
                tank2Fuel = totalFuel / 2;
                centralFuel = 0;
            } else {
                tank1Fuel = config.wingTankCapacity;
                tank2Fuel = config.wingTankCapacity;
                centralFuel = totalFuel - wingTanksTotalCapacity;
            }

            updateUI(totalFuel, centralFuel, tank1Fuel, tank2Fuel, config);
        }
        
        function formatNumber(num) {
            return Math.round(num).toLocaleString('pt-BR');
        }

        function updateUI(totalFuel, central, tank1, tank2, config) {
            document.getElementById('resultCentral').textContent = `${formatNumber(central)} KG`;
            document.getElementById('resultTank1').textContent = `${formatNumber(tank1)} KG`;
            document.getElementById('resultTank2').textContent = `${formatNumber(tank2)} KG`;
            document.getElementById('totalLitros').textContent = `${formatNumber(totalFuel / FUEL_DENSITY)} L`;

            const tank1PercentOfTotal = totalFuel > 0 ? (tank1 / totalFuel) * 100 : 0;
            const centralPercentOfTotal = totalFuel > 0 ? (central / totalFuel) * 100 : 0;
            const tank2PercentOfTotal = totalFuel > 0 ? (tank2 / totalFuel) * 100 : 0;

            document.getElementById('resultTank1Percent').textContent = `(${tank1PercentOfTotal.toFixed(1).replace('.', ',')}%)`;
            document.getElementById('resultCentralPercent').textContent = `(${centralPercentOfTotal.toFixed(1).replace('.', ',')}%)`;
            document.getElementById('resultTank2Percent').textContent = `(${tank2PercentOfTotal.toFixed(1).replace('.', ',')}%)`;

            const visTank1 = document.getElementById('visTank1');
            const visTankCenter = document.getElementById('visTankCenter');
            const visTank2 = document.getElementById('visTank2');

            const tank1FillPercentage = (tank1 / config.wingTankCapacity) * 100;
            const tank2FillPercentage = (tank2 / config.wingTankCapacity) * 100;
            const centerCapacity = config.maxCapacity - (config.wingTankCapacity * 2);
            const centerFillPercentage = centerCapacity > 0 ? (central / centerCapacity) * 100 : 0;

            visTank1.style.height = `${tank1FillPercentage}%`;
            visTankCenter.style.height = `${centerFillPercentage}%`;
            visTank2.style.height = `${tank2FillPercentage}%`;
            
            visTank1.title = `${tank1FillPercentage.toFixed(1).replace('.', ',')}%`;
            visTankCenter.title = `${centerFillPercentage.toFixed(1).replace('.', ',')}%`;
            visTank2.title = `${tank2FillPercentage.toFixed(1).replace('.', ',')}%`;
            
            resultsDiv.classList.remove('hidden');
        }

        window.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                closeModal();
            }
        });

        const visTank1 = document.getElementById('visTank1');
        const visTankCenter = document.getElementById('visTankCenter');
        const visTank2 = document.getElementById('visTank2');

        function showClickTooltip(element) {
            const text = element.title;
            if (!text) return;

            const existingTooltip = document.querySelector('.click-tooltip');
            if (existingTooltip) {
                existingTooltip.remove();
            }

            const tooltip = document.createElement('div');
            tooltip.className = 'click-tooltip';
            tooltip.textContent = text;
            document.body.appendChild(tooltip);

            const rect = element.getBoundingClientRect();
            tooltip.style.left = `${rect.left + rect.width / 2}px`;
            tooltip.style.top = `${rect.top + 10}px`;
            tooltip.style.transform = 'translateX(-50%)';

            setTimeout(() => {
                tooltip.style.opacity = '0';
                setTimeout(() => {
                    if (tooltip) tooltip.remove();
                }, 300);
            }, 2000);
        }

        visTank1.addEventListener('click', () => showClickTooltip(visTank1));
        visTankCenter.addEventListener('click', () => showClickTooltip(visTankCenter));
        visTank2.addEventListener('click', () => showClickTooltip(visTank2));
    </script>
</body>
</html>